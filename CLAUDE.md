# CLAUDE.md - AI Assistant Guide

## Quick Start

**Project**: Bilingual psychology website for Rocío Touza Sanchez
**Live**: https://rociotouzasanchez.com
**Tech**: 11ty + Nunjucks + JSON + Tailwind CSS + Vanilla JS
**Hosting**: GitHub Pages (auto-deploy from main branch)

**Setup**: `npm install` → `npm run serve` (dev) or `npm run build` (production)

---

## Technology Stack

| Tech | Purpose |
|------|---------|
| **11ty (Eleventy)** | Static site generator |
| **Nunjucks** | Templating engine |
| **JSON** | Content data (`src/_data/es.json`, `src/_data/en.json`) |
| **Tailwind CSS** | Styling (CDN v3.x + custom config) |
| **Vanilla JS** | Mobile menu, smooth scrolling |
| **GitHub Actions** | CI/CD automation |
| **Open Sans Variable** | Self-hosted typography |

---

## File Structure

```
src/
├── index.njk                      # Homepage template
├── _data/
│   ├── es.json                    # Spanish content
│   └── en.json                    # English content
└── _includes/
    ├── layouts/base.njk           # Main HTML layout
    └── components/
        ├── nav.njk, hero.njk, about.njk, services.njk
        ├── modalities.njk, faq.njk, footer.njk
        └── floating-button.njk, meta.njk

_site/                             # Output (generated by 11ty)
├── index.html                     # Spanish homepage
└── en/index.html                  # English homepage

.eleventy.js                       # Build config
package.json                       # npm scripts
README.md, ROADMAP.md, CLAUDE.md  # Docs
```

**Build Process**: `npm run build` → 11ty reads `src/` → generates `_site/`
**Deployment**: Push to main → GitHub Actions auto-builds and deploys to gh-pages

---

## Architecture Overview

### Single-Page App with 5 Sections
1. **Hero** (`#inicio`) - Welcome + CTA + session info
2. **About** (`#sobre-mi`) - Bio, credentials, approach
3. **Services** (`#servicios`) - Specialization areas
4. **Modalities** (`#modalidades`) - Online/in-person, pricing
5. **FAQ** (`#faq`) - 12 common questions

**Footer**: Contact info, no separate contact section (WhatsApp-first UX)

### Bilingual Architecture
- **Single JSON source**: Spanish and English in separate files with identical structure
- **Template reuse**: One template (`index.njk`) generates both `/index.html` and `/en/index.html`
- **11ty pagination**: Automatically creates both language versions
- **Language switcher**: URL-based links (no JS toggle)

---

## Design System

### Colors
```
forest-green: #4D7C6A    (primary, buttons, accents)
cream: #F5F3E5           (backgrounds)
navy: #1D3557            (text, headings)
sage: #93ADA1            (secondary accents)
dark-gray: #333333       (body text)
```

### Typography
- **Font**: Open Sans Variable (self-hosted, 300-800 weights)
- **Classes**: `font-playfair`, `font-open-sans`, `font-sans` all use Open Sans
- **Fallback**: System fonts (no external tracking)

### Components
- **Service Cards**: White, rounded-2xl, shadow, hover lift effect
- **Buttons**: Primary (forest-green), Secondary (navy outline), Float (WhatsApp)
- **Layout**: Max-width 1280px, section padding py-20

---

## Development Workflow

### Local Development
```bash
npm run serve          # Start dev server, auto-reload on file changes
npm run build          # One-time build to _site/
npm run clean          # Remove generated files
```

### Making Changes
1. **Edit content**: Update `src/_data/es.json` or `src/_data/en.json`
2. **Edit templates**: Modify `.njk` files in `src/_includes/`
3. **Always update both**: Keep `es.json` and `en.json` in sync
4. **Test both languages**: Visit `/` and `/en/` locally
5. **Commit and push**: GitHub Actions auto-deploys to live site

### Key Files to Edit
| Need | Where |
|------|-------|
| Change text/pricing | `src/_data/es.json` + `en.json` |
| Update layout | `src/_includes/components/` |
| Add new section | New file in `components/` + data in JSON |
| Update navigation | `nav` object in JSON files |

### Testing Checklist
- [ ] Build succeeds: `npm run build` without errors
- [ ] Both languages: `/` and `/en/` render correctly
- [ ] Mobile menu opens/closes
- [ ] Smooth scrolling works
- [ ] No console errors
- [ ] Responsive design (mobile, tablet, desktop)
- [ ] WhatsApp links functional

---

## Git Workflow

**Branch naming**: `claude/{descriptive-name}` (required)
**Commits**: Descriptive messages, present tense (e.g., "Update service descriptions")

```bash
git checkout -b claude/your-feature
# Make changes
npm run build && npm run serve  # Test locally
git add . && git commit -m "Your message"
git push -u origin claude/your-feature
# Create PR on GitHub → wait for approval → merge to main
# GitHub Actions auto-deploys after merge
```

**Important**: Main branch is protected. All changes require PR approval.

---

## JSON Data Structure

Both `es.json` and `en.json` follow this pattern:

```json
{
  "lang": "es",
  "locale": "es_ES",
  "site": {
    "title": "...",
    "phone": "+34...",
    "email": "...",
    "location": "..."
  },
  "meta": {
    "title": "...",
    "description": "...",
    "keywords": "...",
    "ogImage": "..."
  },
  "nav": { "title": "...", "links": [...] },
  "hero": { "title": "...", "cta": "...", "sessionPrice": "..." },
  "about": { "title": "...", "credentials": "..." },
  "services": { "title": "...", "cards": [...] },
  "modalities": { "title": "...", "options": [...] },
  "faq": { "title": "...", "items": [...] },
  "footer": { "copyright": "..." }
}
```

**Key principle**: Identical structure between files, translated content only.

---

## Common Tasks

### Update Text Content
1. Find section in `src/_data/es.json` or `en.json`
2. Update both files with same structure
3. Run `npm run build`
4. Test both languages

### Add New Service
1. Edit `src/_data/es.json`: Add to `services.cards` array
2. Edit `src/_data/en.json`: Same structure, English text
3. Template auto-loops through cards - no template edits needed
4. Find icon at [Material Design Icons](https://materialdesignicons.com/)

### Update Pricing
1. Find price field in JSON (usually `hero.sessionPrice` or `modalities.pricing`)
2. Update both Spanish and English versions
3. Search other sections if price mentioned elsewhere
4. Build and verify both languages

### Add New Section
1. Create template: `src/_includes/components/new-section.njk`
2. Add data to `src/_data/es.json` and `en.json`
3. Include in `src/index.njk`
4. Update navigation JSON + sitemap.xml
5. Build and test both languages

### Fix Responsive Design
1. Use `npm run serve` for live preview
2. Test with DevTools device toolbar (mobile/tablet/desktop)
3. Edit Nunjucks files in `src/_includes/`
4. Use Tailwind prefixes: `md:`, `lg:`, `xl:`
5. Rebuild: `npm run build`

### Deploy to Live Site
1. Make changes in `src/`
2. Test locally: `npm run serve`
3. Build: `npm run build`
4. Commit: `git add . && git commit -m "message"`
5. Push: `git push origin claude/branch-name`
6. Create PR on GitHub → merge to main
7. GitHub Actions auto-builds and deploys

---

## Key Features

### Language Switcher
- **ES version** (`/`): Links to `/en/` (EN shown in gray)
- **EN version** (`/en/`): Links to `/` (ES shown in gray)
- Implementation: HTML links in `nav.njk` (no JS)

### Mobile Menu
- Hamburger button toggles `hidden` class (vanilla JS)
- Auto-closes on link click
- Location: `src/_includes/components/nav.njk`

### WhatsApp Integration
- Floating button (fixed bottom-right)
- Links: `https://wa.me/[COUNTRY_CODE][PHONE]?text=[MESSAGE]`
- Data source: `site.phone` in JSON
- Used in: Hero CTAs, nav buttons, footer, float button

### Smooth Scrolling
- Native CSS + JS fallback
- 80px offset for fixed navigation
- All anchor links auto-handled via event delegation

### SEO Features
- Meta tags (description, keywords, OG) from JSON
- JSON-LD structured data (Schema.org Psychologist)
- Sitemap.xml with bilingual URLs
- Hreflang tags for language variants
- Semantic HTML5 structure
- No analytics/tracking (privacy-first)

---

## Integrations Status

| Integration | Status | Details |
|-------------|--------|---------|
| WhatsApp | ✅ CONFIGURED | Direct booking links throughout site |
| Privacy Policy | ✅ CONFIGURED | Bilingual pages (GDPR/LOPD compliant) |
| Google Analytics | ❌ NOT USED | Intentional (privacy-first approach) |

**Philosophy**: No tracking, no cookies, no consent banners. Users browse anonymously.

---

## Code Conventions

### Nunjucks Templates
```nunjucks
{{ variable }}                    # Output
{% if condition %}...{% endif %}  # Conditionals
{% for item in array %}...{% endfor %}  # Loops
{{ data[lang].section.field }}   # Data access (always dynamic)
```

- Indentation: 2 spaces
- Comments: `{# Comment #}`

### JSON
```json
{
  "key": "value",
  "camelCase": "naming convention",
  "arrays": ["for", "lists"]
}
```

- Indentation: 2 spaces
- Structure identical between es.json and en.json

### CSS (Tailwind)
- Use Tailwind utilities first
- Mobile-first: design for mobile, add `md:` and `lg:` for larger screens
- Custom CSS only if Tailwind can't solve it

### JavaScript
- Vanilla ES6+ only (no frameworks)
- Keep in `src/_includes/layouts/base.njk`
- Minimal code: mobile menu, smooth scroll, event listeners

---

## Troubleshooting

### Build Fails
**Solutions**:
1. Check JSON syntax: Use https://jsonlint.com/
2. Verify includes: All files in `src/_includes/` exist
3. Clean and rebuild: `npm run clean && npm run build`
4. Check for missing commas, quotes, or brackets in JSON

### Changes Don't Appear
**Solutions**:
1. Always edit in `src/`, never `_site/` (generated)
2. Hard refresh: Cmd+Shift+R (Mac) or Ctrl+Shift+R (Windows)
3. Rebuild: `npm run build`
4. Check output: `_site/index.html` has changes

### Language Not Switching
**Solutions**:
1. Check nav links in `src/_includes/components/nav.njk`
2. Verify both `_site/index.html` and `_site/en/index.html` exist
3. Test URLs: `http://localhost:8080/` and `http://localhost:8080/en/`

### Mobile Menu Stuck
**Solutions**:
1. Check console (F12) for JS errors
2. Verify IDs exist: `mobileMenuBtn`, `mobileMenu`
3. Rebuild: `npm run clean && npm run build`

### Images Not Loading
**Solutions**:
1. Images must be in `/images/` directory
2. Paths in templates: `/images/filename.jpg` (absolute from root)
3. Check `.eleventy.js` for passthrough copy config
4. Run: `npm run build` to copy files

### Push Fails (403 Error)
**Solutions**:
1. Branch must start with `claude/`
2. Check permissions: `git remote -v`
3. Try: `git push -u origin HEAD`

---

## SEO Optimization

### Current Features
- ✅ Semantic HTML5
- ✅ Meta tags (description, keywords, OG)
- ✅ Structured data (JSON-LD, Schema.org)
- ✅ Sitemap + robots.txt
- ✅ Mobile-responsive
- ✅ Fast loading (self-hosted fonts, minimal JS)
- ✅ Proper heading hierarchy
- ✅ Alt text on images
- ✅ Canonical URLs + hreflang

### Maintenance
**When updating content**:
1. Update meta description if main focus changes
2. Update sitemap.xml lastmod dates
3. Verify keyword placement in visible text
4. Check heading hierarchy (H1 → H2 → H3)

---

## Accessibility (a11y)

### Current
- ✅ Semantic HTML (nav, section, footer)
- ✅ Lang attribute (switches with language)
- ✅ ARIA labels on interactive elements
- ✅ Keyboard navigation
- ✅ Color contrast ratios

### Improvements Needed
- Add alt text to images
- Add skip-to-content link
- Test with screen readers

---

## Performance

### Strengths
- Static HTML (fast)
- Minimal JS (~60 lines)
- Self-hosted fonts (no external requests)
- CDN Tailwind (lightweight)

### Opportunities
- Image optimization (WebP, lazy loading)
- Minification for production
- Service worker for offline

---

## Privacy & Security

### Cookie-Free Design
- No Google Analytics
- No tracking pixels
- No session cookies
- No consent banners needed
- GDPR/LOPD compliant

### Security
- Static files only (no server vulnerabilities)
- HTTPS via GitHub Pages
- No sensitive data in code
- Self-hosted assets (no third-party tracking)

---

## Resources

**11ty**: [Documentation](https://www.11ty.dev/)
**Tailwind**: [Documentation](https://tailwindcss.com/docs)
**Icons**: [Material Design Icons](https://materialdesignicons.com/)
**SEO**: [Schema.org](https://schema.org/Psychologist)
**A11y**: [WCAG 2.1](https://www.w3.org/WAI/WCAG21/quickref/)

---

## Project Roadmap

See `ROADMAP.md` for detailed improvement plan, priorities, and status.

**Recently Completed**:
- ✅ 11ty migration (December 18, 2025)
- ✅ JSON content management system
- ✅ Bilingual template generation
- ✅ GitHub Actions CI/CD automation

**Next Priority**: SEO optimization (Barcelona keywords, structured data)

---

## For AI Assistants Working on This Project

When making changes, always:
1. Test locally before pushing: `npm run serve`
2. Verify both language versions (`/` and `/en/`)
3. Test responsive design (mobile/tablet/desktop)
4. Use branch naming: `claude/{descriptive-name}`
5. Write clear commit messages
6. Run `npm run build` before committing
7. Never commit private info (phone, email, IDs) to docs
8. Use placeholders: `info@example.com`, `+XX XXX XXX XXX`
9. Respect privacy-first philosophy (no tracking)

**Contact**: Website owner at [rociotouzasanchez.com](https://rociotouzasanchez.com)

---

**Last Updated**: December 18, 2025
**Version**: 4.1.0 - Optimized Documentation
**Maintained By**: Claude AI Assistant
